var app=app||{};app.SearchView=Backbone.View.extend({el:"form",events:{"click #search-button":"search"},initialize:function(){that=this,this.$input=this.$("#search"),this.$searchResults=this.$(".search-results"),this.listenTo(app.Foods,"add",this.addOne),this.listenTo(app.Foods,"reset",this.addAll),this.listenTo(app.Results,"add",this.addOneResult),this.listenTo(app.Results,"reset",this.addAllResult),app.Foods.fetch()},addOne:function(a){var b=new app.FoodView({model:a});$("#food-list").append(b.render().el)},addAll:function(){this.$("#food-list").html(""),app.Foods.each(this.addOne,this)},addOneResult:function(a){var b=new app.ResultsView({model:a});$(".search-results").append(b.render().el)},addAllResult:function(){this.$(".search-results").html(""),app.Results.each(this.addOne,this)},search:function(){event.preventDefault();var a=this.$input.val().trim(),b="https://api.nutritionix.com/v1_1/search/"+a+"?results=0%3A10&cal_min=0&cal_max=50000&fields=item_name%2Cbrand_name%2Cnf_calories%2Cnf_total_fat%2Cnf_saturated_fat&appId=c2194c02&appKey=1ee171e5e11a6ba6f3d7ff9002fc9480";if(app.Results.reset(),!a)return this.$searchResults.text("Please enter something.."),!1;this.$searchResults.text("Loading..."),$.ajax({url:b,dataType:"json",success:function(a){that.$searchResults.text("");var b=a.hits,c=b.length;if(0===c)return that.$searchResults.text("No results"),!1;for(var d=0;d<c;d++)app.Results.create({brandname:b[d].fields.brand_name,name:b[d].fields.item_name,calories:b[d].fields.nf_calories,total_fat:b[d].fields.nf_total_fat})}}).error(function(){that.$searchResults.text("Something went wrong..")}),this.$input.val("")}});